function statusChangeCallback(e){"connected"===e.status?e.authResponse&&FB.api("/me/accounts",function(e){var t=0;$.each(e.data,function(e,a){++t,"192272534234138"==a.id&&$("#fbPostModal .modal-body #tokenId").val(a.access_token)})}):"not_authorized"===e.status}function facebookLogin(){return FB.login(function(e){statusChangeCallback(e)},{scope:"email,public_profile,publish_pages,manage_pages"}),!1}function sendFile(e,t,a){var n=new FormData;n.append("file_upload",e),$.ajax({url:"/events/desc_upload",data:n,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(e){t.insertImage(a,e)},error:function(e,t,a){}})}function handleLocationError(e,t,a){t.setPosition(a),t.setContent(e?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation.")}function CustomMarker(e,t,a){this.latlng=e,this.args=a,this.setMap(t)}function initialize(){function e(e,t){if("undefined"!=typeof c){window.branch_marker.length>0&&$.each(window.branch_marker,function(e,t){window.markers[t].setMap(null)}),CustomMarker.prototype=new mapObj.OverlayView,CustomMarker.prototype.draw=function(){var e=this,t=this.div;if(!t){t=this.div=document.createElement("div"),t.className="marker",t.style.position="absolute",t.style.cursor="pointer",t.style.width="43px",t.style.height="42px",t.style.margin="-20px 0px 0px -10px",t.innerHTML='<img src="'+base_url+'/assets/img/pin_icon_white.png" stye="position: absolute; top: 0px; left: 0px; clip: rect(0px, 40px, 40px, 0px);" /><div class="text-count" style="position: absolute; top: 0px;left: 5px; color: #ffffff; font-size: 12px; font-family: Arial,sans-serif; font-weight: bold; font-style: normal; text-decoration: none; text-align: center; width: 30px; line-height:30px;"><img src="'+e.args.brand_logo+'" width="30" height="30" class="img-brand-branch" /></div>',"undefined"!=typeof e.args.marker_id&&(t.dataset.marker_id=e.args.marker_id),d.event.addDomListener(t,"click",function(e){});var a=this.getPanes();a.overlayImage.appendChild(t)}var n=this.getProjection().fromLatLngToDivPixel(this.latlng);n&&(t.style.left=n.x-10+"px",t.style.top=n.y-20+"px")},CustomMarker.prototype.remove=function(){this.div&&(this.div.parentNode.removeChild(this.div),this.div=null)},CustomMarker.prototype.getPosition=function(){return this.latlng},window.latlngboundsBranch=new d.LatLngBounds;var a;"promotion"==t?a="/events/locations/"+e:"brand"==t&&(a="/brand/locations/"+e),$.ajax({url:a,type:"GET",datatype:"JSON",processData:!1,contentType:!1,success:function(e){var t=$.parseJSON(e),a=t.brand.name,n=t.brand.url_slug,r=t.brand.image,i=t.brand.category_slug,o=t.brand.category;null==r&&(r="assets/img/profiles/e.jpg"),$(".modal .thumbnail-wrapper img").attr("src",base_url+"/"+r).attr("alt",a),$(".modal .brand-event-url").attr("href",base_url+"/brand/"+n).attr("title",a).html(a),$(".modal .category-event-url").attr("href",base_url+"/category/"+i).attr("title",o).html(o),$(".modal span.brand").html(a),window.events_locations=new Array;var s=0;$.each(t.locations,function(e,t){var a=[];$.each(t,function(e,t){a.push(t)}),window.events_locations[e]=a;var n=e.split(","),r=n[2],i=n[0],o=n[1];s>0?$("#modal_map .brand_branch_list").append(', <span><i aria-hidden="true" class="pg-map hint-text-9"></i></span><a class="place" data-index="'+e+'" title="'+r+'" href="#'+r+'">'+r+"</a>"):$("#modal_map .brand_branch_list").html("").append('<span><i aria-hidden="true" class="pg-map hint-text-9"></i></span><a class="place" data-index="'+e+'" title="'+r+'" href="#'+r+'">'+r+"</a>"),s++;var l=$("#modal_map .thumbnail-wrapper img").attr("src"),d=new mapObj.LatLng(i,o);window.markers[e]=new CustomMarker(d,c,{marker_id:e,event_count:1,brand_logo:l,latlon:d,marker_name:r}),window.branch_marker.push(e),window.latlngboundsBranch.extend(d)}),d.event.trigger(c,"resize"),c.fitBounds(window.latlngboundsBranch)},error:function(e,t,a){}})}}var t=[{stylers:[{hue:"#fff"},{saturation:-100}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:50},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]}];mapObj=new Object(google.maps);var a=new mapObj.LatLng(13.7563309,100.50176510000006),n=mapObj.MapTypeId.ROADMAP,r=base_url+"/assets/img/basket.png",i={zoom:14,scrollwheel:!0,center:a,mapTypeId:n,disableDefaultUI:!1};if($("#map_canvas").exists()){window.latlngbounds=new mapObj.LatLngBounds;var o=$("#map_canvas")[0];map=new mapObj.Map(o,i),map.setOptions({styles:t,clickableIcons:!1}),mapObj.event.addListener(map,"zoom_changed",function(){$("#location_zoom").val(map.getZoom())});var s=new mapObj.InfoWindow,l=new mapObj.Marker({map:map,icon:r,anchorPoint:new mapObj.Point(0,-29)})}if($("#map_canvas_branch").exists()&&null==document.getElementById("event_id")){var c,d,u="";d=new Object(google.maps);var p=$("#map_canvas_branch")[0];c=new d.Map(p,i),d.event.addListener(c,"zoom_changed",function(){$("#branch_location_zoom").val(c.getZoom())});var m=new d.InfoWindow,h=new d.Marker({map:c,icon:r,anchorPoint:new mapObj.Point(0,-29)})}if($(".map-full").exists()){var t=[];map.setOptions({styles:t,clickableIcons:!1});var f="/maps/locations";$("#location_branch_lat").val()>0&&$("#location_branch_lon").val()>0&&(f="/map/latlon/"+$("#location_branch_lat").val()+"/"+$("#location_branch_lon").val()),CustomMarker.prototype=new mapObj.OverlayView,CustomMarker.prototype.draw=function(){var e=this,t=this.div;if(!t){t=this.div=document.createElement("div"),t.className="marker",t.style.position="absolute",t.style.cursor="pointer",t.style.width="40px",t.style.height="40px",t.style.margin="-20px 0px 0px -10px",t.innerHTML='<img src="'+base_url+'/assets/img/pin_icon.png" stye="position: absolute; top: 0px; left: 0px; clip: rect(0px, 40px, 40px, 0px);" /><div class="text-count" style="position: absolute; top: 0px;left: 5px; color: #ffffff; font-size: 12px; font-family: Arial,sans-serif; font-weight: bold; font-style: normal; text-decoration: none; text-align: center; width: 30px; line-height:30px;">'+e.args.event_count+"</div>","undefined"!=typeof e.args.marker_id&&(t.dataset.marker_id=e.args.marker_id),mapObj.event.addDomListener(t,"click",function(t){s.setContent('<div class="popup_container"><strong class="marker_name text-master">'+e.args.marker_name+'</strong></div><p><a href="#" data-index="'+e.args.marker_id+'" class="events_locations">มี '+e.args.event_count+" โปรโมชั่นที่นี่</a></p>"),s.open(map,e),map.panTo(e.args.latlon)});var a=this.getPanes();a.overlayImage.appendChild(t)}var n=this.getProjection().fromLatLngToDivPixel(this.latlng);n&&(t.style.left=n.x-10+"px",t.style.top=n.y-20+"px")},CustomMarker.prototype.remove=function(){this.div&&(this.div.parentNode.removeChild(this.div),this.div=null)},CustomMarker.prototype.getPosition=function(){return this.latlng},window.latlngbounds=new mapObj.LatLngBounds,$.ajax({url:f,type:"GET",datatype:"JSON",success:function(e){var t=$.parseJSON(e);$.isEmptyObject(t)||(window.events_locations=new Array,$.each(t,function(e,t){var a=[];$.each(t,function(e,t){a.push(t)}),window.events_locations[e]=a;var n=e.split(","),r=n[2],i=n[0],o=n[1],s=new mapObj.LatLng(i,o);overlay=new CustomMarker(s,map,{marker_id:e,event_count:a.length,latlon:s,marker_name:r}),window.latlngbounds.extend(s)}),$(document).on("click",".events_locations",function(e){var t=$(this).data("index");return $("#filters.maps").removeClass("open"),$("ul#map-items").html(""),$.each(window.events_locations[t],function(e,t){var a='<li class="map-event-list clearfix text-master">';a+='<div class="col-xs-12 col-top padding-5">',a+='<div class="relate-header-group"><a target="_blank" href="/brand/'+t.brand_slug+'" title="'+t.brand+'"><span class="thumbnail-wrapper d32 circular pull-left"><img width="34" height="34" class="col-top" src="/'+t.brand_logo+'" data-src="/'+t.brand_logo+'" data-src-retina="/'+t.brand_logo+'" alt="'+t.brand+'"></span></a>',a+='<div class="pull-left padding-0 p-l-5 col-xs-10">',a+='<div class="col-md-12 padding-0 relate-event-header"><span class="text-master col-sm-6 pull-left padding-0"><a class="relate-brand-url" title="'+t.brand+'" href="/brand/'+t.brand_slug+'">'+t.brand+"</a></span>",a+='<span class="block text-master hint-text fs-12 col-sm-6 pull-right align-right padding-0"><a class="relate-category-url" title="'+t.category+'" href="/category/'+t.category_slug+'">'+t.category+"</a></span></div></div></div>",a+='<div class="full-width clearfix relate-event-body p-l-5 p-r-10"><a target="_blank" title="'+t.title+'" href="/'+t.slug+'"><div class="relate-event-image"><div class="relate-img-thumb full-width m-t-5 m-b-5" width="100%" style="background-image: url('+base_url+"/"+t.image+');"></div></a></div>',a+='<p class="relate-event-title"><a target="_blank" title="'+t.title+'" href="/'+t.slug+'">'+t.title+"</a></p>",a+='<p class="block text-master hint-text fs-12"><i class="fa fa-calendar" aria-hidden="true"></i> '+t.start_date_thai+" - "+t.end_date_thai+"</p>",a+="</div></div></li>",$("ul#map-items").append(a)}),$("#filters .map-location").html($(this).closest("div").find(".marker_name").html()),$("#filters.maps").addClass("open"),!1}),map.fitBounds(window.latlngbounds))},error:function(e,t,a){}});$(document).on("click","#map-user-location",function(e){navigator.geolocation.getCurrentPosition(function(e){({lat:e.coords.latitude,lng:e.coords.longitude});$.cookie("latlonUser",e.coords.latitude+","+e.coords.longitude),window.infowindow_user&&window.infowindow_user.close();var t=new mapObj.LatLng(e.coords.latitude,e.coords.longitude);window.infowindow_user=new mapObj.InfoWindow({map:map,position:t,content:"คุณอยู่ที่นี่"}),""!=window.latlngbounds?(window.latlngbounds.extend(t),c.fitBounds(window.latlngbounds)):c.setCenter(t)},function(){handleLocationError(!0,s,map.getCenter())})})}if($(".event_slug").exists()&&$.ajax({url:"/events/locations/"+$(".event_slug").val(),type:"GET",datatype:"JSON",processData:!1,contentType:!1,success:function(e){var t=$.parseJSON(e),a=[];window.events_locations=new Array,$.each(t.locations,function(e,t){var n=[];$.each(t,function(e,t){n.push(t)}),window.events_locations[e]=n;var i=e.split(","),o=i[2],l=i[0],c=i[1],d=new mapObj.LatLng(l,c);a[e]=new mapObj.Marker({position:d,map:map,title:o,icon:r}),mapObj.event.addListener(a[e],"click",function(){s.setContent('<div class="popup_container"><strong class="marker_name text-master">'+o+'</strong></div><p><a href="#" data-index="'+e+'" class="events_locations">ดูโปรโมชั่นอื่นๆ ของที่นี่</a></p>'),s.open(map,a[e]),map.panTo(a[e].getPosition())}),window.latlngbounds.extend(a[e].position)}),map.setCenter(window.latlngbounds.getCenter()),map.fitBounds(window.latlngbounds),$(document).on("click",".events_locations",function(e){var t=$(this).data("index");return $("#filters.maps").removeClass("open"),$("ul#map-items").html(""),$.each(window.events_locations[t],function(e,t){var a='<li class="map-event-list clearfix text-master">';a+='<div class="col-xs-12 col-top padding-5">',a+='<div class="relate-header-group"><a target="_blank" href="/brand/'+t.brand_slug+'" title="'+t.brand+'"><span class="thumbnail-wrapper d32 circular pull-left"><img width="34" height="34" class="col-top" src="/'+t.brand_logo+'" data-src="/'+t.brand_logo+'" data-src-retina="/'+t.brand_logo+'" alt="'+t.brand+'"></span></a>',a+='<div class="pull-left padding-0 p-l-5 col-xs-10">',a+='<div class="col-md-12 padding-0 relate-event-header"><span class="text-master col-sm-6 pull-left padding-0"><a class="relate-brand-url" title="'+t.brand+'" href="/brand/'+t.brand_slug+'">'+t.brand+"</a></span>",a+='<span class="block text-master hint-text fs-12 col-sm-6 pull-right align-right padding-0"><a class="relate-category-url" title="'+t.category+'" href="/category/'+t.category_slug+'">'+t.category+"</a></span></div></div></div>",a+='<div class="full-width clearfix relate-event-body p-l-5 p-r-10"><a target="_blank" title="'+t.title+'" href="/'+t.slug+'"><div class="relate-event-image"><div class="relate-img-thumb full-width m-t-5 m-b-5" width="100%" style="background-image: url('+base_url+"/"+t.image+');"></div></a></div>',a+='<p class="relate-event-title"><a target="_blank" title="'+t.title+'" href="/'+t.slug+'">'+t.title+"</a></p>",a+='<p class="block text-master hint-text fs-12"><i class="fa fa-calendar" aria-hidden="true"></i> '+t.start_date_thai+" - "+t.end_date_thai+"</p>",a+="</div></div></li>",$("ul#map-items").append(a)}),""==window.events_locations[t]&&$("ul#map-items").html('<div class="col-md-12 text-master m-t-10 hint-text">ไม่มีโปรโมชั่นอื่นๆที่นี่</div>'),$("#filters .map-location").html($(this).closest("div").find(".marker_name").html()),$("#filters.maps").addClass("open"),!1}),$(".event").on("click",".place",function(e){var t=$(this).data("index");return mapObj.event.trigger(a[t],"click"),!1})},error:function(e,t,a){}}),$("#event_location").exists()){var g=document.getElementById("event_location"),v=new mapObj.places.Autocomplete(g);if(v.bindTo("load",map),v.addListener("place_changed",function(){return s.close(),l.setVisible(!1),place=v.getPlace(),place.geometry?(map.setZoom(17),map.setCenter(place.geometry.location),place.geometry.viewport&&map.fitBounds(place.geometry.viewport),l.setPosition(place.geometry.location),l.setVisible(!0),$("#location_lat").val(place.geometry.location.lat()),$("#location_lon").val(place.geometry.location.lng()),s.setContent('<div><strong class="text-master">'+place.name+"</strong></div>"),void s.open(map,l)):void window.alert("Autocomplete's returned place contains no geometry")}),$(".event_location_name").exists()&&""!=$(".event_location_name").val()){var b,_=$(".event_location_name").val(),w=$("#location_lat").val(),y=$("#location_lon").val(),x=parseInt($("#location_zoom").val()),k=new mapObj.LatLng(w,y);b=new mapObj.Marker({position:k,map:map,title:_,icon:r}),mapObj.event.addListener(b,"click",function(){s.setContent('<div><strong class="text-master">'+_+"</strong></div>"),s.open(map,b),map.panTo(b.getPosition())}),window.latlngbounds.extend(b.position),map.setZoom(x),map.setCenter(window.latlngbounds.getCenter())}mapObj.event.addListener(l,"click",function(){s.setContent('<div><strong class="text-master">'+place.name+"</strong></div>"),s.open(map,l)})}if($("#branch_location").exists()){var T=document.getElementById("branch_location"),O=new d.places.Autocomplete(T);O.bindTo("load",c),O.addListener("place_changed",function(){return m.close(),h.setVisible(!1),u=O.getPlace(),u.geometry?(c.setZoom(17),c.setCenter(u.geometry.location),u.geometry.viewport&&c.fitBounds(u.geometry.viewport),h.setPosition(u.geometry.location),h.setVisible(!0),$("#branch_location_lat").val(u.geometry.location.lat()),$("#branch_location_lon").val(u.geometry.location.lng()),m.setContent('<div><strong class="text-master">'+u.name+"</strong></div>"),void m.open(c,h)):void window.alert("Autocomplete's returned place contains no geometry")}),d.event.addListener(h,"click",function(){m.setContent('<div><strong class="text-master">'+u.name+"</strong></div>"),m.open(c,h)}),$(document).on("click",".add_new_branch",function(e){$(".new_branch_panel").toggle(),$("i.pg-minus",this).toggleClass("pg-plus"),"none"!=$(".new_branch_panel").css("display")&&($("#branch_location").val(""),m.close(),h.setVisible(!1),c.setZoom(14),d.event.trigger(c,"resize"),c.setCenter(a))})}$(document).on("click","#btn-user-location",function(e){navigator.geolocation.getCurrentPosition(function(e){({lat:e.coords.latitude,lng:e.coords.longitude});window.infowindow_user&&window.infowindow_user.close();var t=new mapObj.LatLng(e.coords.latitude,e.coords.longitude);window.infowindow_user=new mapObj.InfoWindow({map:c,position:t,content:"คุณอยู่ที่นี่"}),""!=window.latlngboundsBranch?(window.latlngboundsBranch.extend(t),c.fitBounds(window.latlngboundsBranch)):c.setCenter(t)},function(){handleLocationError(!0,s,map.getCenter())})}),$("#modal_map").on("show.bs.modal",function(t){if("undefined"!=typeof c){var a=$(t.relatedTarget).data("slug"),n=$(t.relatedTarget).data("type");setTimeout(function(){e(a,n)},400)}}),$(document).on("click",".btn_branch_delete",function(e){$(this).closest(".branch_row").remove()})}var events_locations,markers=[],branch_marker=[],infowindow_user,latlngbounds,latlngboundsBranch,branch_list,fx_select_brand;!function(e){"use strict";e(document).ready(function(){var t=function(){var e=0;return function(t,a){clearTimeout(e),e=setTimeout(t,a)}}();!function(e,t){var a=function(e,t,a){var n;return function(){function r(){a||e.apply(i,o),n=null}var i=this,o=arguments;n?clearTimeout(n):a&&e.apply(i,o),n=setTimeout(r,t||100)}};jQuery.fn[t]=function(e){return e?this.bind("resize",a(e)):this.trigger(t)}}(jQuery,"smartresize"),function(e,t){function a(){if(!i){i=!0;for(var e=0;e<r.length;e++)r[e].fn.call(window,r[e].ctx);r=[]}}function n(){"complete"===document.readyState&&a()}e=e||"docReady",t=t||window;var r=[],i=!1,o=!1;t[e]=function(e,t){return i?void setTimeout(function(){e(t)},1):(r.push({fn:e,ctx:t}),void("complete"===document.readyState?setTimeout(a,1):o||(document.addEventListener?(document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",a,!1)):(document.attachEvent("onreadystatechange",n),window.attachEvent("onload",a)),o=!0)))}}("docReady",window);var a,n=e(".day"),a=n.isotope({itemSelector:".col-centered",layoutMode:"masonry",resizable:!1,masonry:{columnWidth:".col1-element"}});if(a.isotope("on","arrangeComplete",function(){}),e(window).on("load",function(){e(".feed").imagesLoaded().progress(function(){a.isotope("layout")});var n=parseInt(e("#paginate_page").val(),10),r=parseInt(e("#total_page").val(),10),i=Math.ceil(r/n);e(".feed .day").infinitescroll({loading:{finished:void 0,finishedMsg:"",img:"/pages/img/progress/progress-circle-success.svg",msg:null,msgText:"",selector:null,speed:"fast",start:void 0},navSelector:".pagination",nextSelector:".pagination a#next",itemSelector:".card.col1-element",debug:!1,dataType:"html",maxPage:i,path:function(e){return"?page="+e},errorCallback:function(){}},function(n,r,i){var o=e(n).css({opacity:0});return o.filter(function(n,r){a.isotope().append(r).isotope("appended",r),e(".feed").imagesLoaded().progress(function(){t(function(){a.isotope("layout")},810)})})})}),e(window).smartresize(function(){t(function(){a.isotope("layout")},810)}),e(".list-view-wrapper").scrollbar(),e(document).on("click.pg.search.data-api",'[data-toggle="search"]',function(t){e(".row_result, .row_result_map").html(""),e(".row_result, .row_result_brand").html(""),e(".result_pro, .result_map, .result_brand").hide(),e("#type_promotion").prop("checked",!0)}),e('[data-pages="search"]').search({searchField:"#overlay-search",closeButton:".overlay-close",suggestions:"#overlay-suggestions",brand:".brand",onSearchSubmit:function(e){},onKeyEnter:function(a){var n;e("#overlay-search"),e(".search-results");if(n=e("input[name=_token]").val(),""!=e("#overlay-search").val()){var r="promotion";if(e(".overlay-content #type_brand").is(":checked"))var r="brand";e(".search-progress").show(),t(function(){e.ajax({url:"/events/search/"+r+"/"+a,headers:{"X-CSRF-TOKEN":n},type:"GET",datatype:"JSON",processData:!1,contentType:!1,success:function(t){e(".search-progress").hide(),e(".result_pro, .result_map, .result_brand").hide(),e(".row_result, .row_result_map, .row_result_brand").html("");var a=e.parseJSON(t);if(e.isEmptyObject(a.event))if(e.isEmptyObject(a.brand))e(".row_result").append('<div class="row p-l-15">ไม่พบข้อมูล...</div>');else{e(".result_brand").show();var n=0;e.each(a.brand,function(t,a){var r=e(".col_hidden_search > div.col_result_brand").clone();if(r.find("span.result-name").html(a.name),r.find("div.search-img-thumb").css("background-image","url(/"+a.logo_image+")"),r.find("a.result-url").attr("href","/brand/"+a.url_slug).attr("title",a.name),r.find("span.result-category").html(a.category),r.find("a.result-category-url").attr("href","/category/"+a.category_slug).attr("title",a.category),r.css("display","block"),n%2==0){var i=e("<div class='row new_index_row_result'></div>").append(r);i.appendTo(".row_result_brand")}else r.appendTo(".row_result_brand .new_index_row_result:last");n++})}else{var n=0;e.each(a.event,function(t,a){e(".result_pro").show();var r=e(".col_hidden_search > div.col_result").clone();if(r.find("span.result-title").html(a.title),r.find("div.search-img-thumb").css("background-image","url(/"+a.image+")"),r.find("span.result-brief").html(a.brief),r.find("a.result-url").attr("href","/"+a.url_slug).attr("title",a.title),r.find("p.result-brand").html("via "+a.brand),r.css("display","block"),n%2==0){var i=e("<div class='row new_index_row'></div>").append(r);i.appendTo(".row_result")}else r.appendTo(".row_result .new_index_row:last");n++})}if(!e.isEmptyObject(a.map)){e(".result_map").show();var n=0;e.each(a.map,function(t,a){var r=e(".col_hidden_search > div.col_result_map").clone();if(r.find("span.result-title").html(a.name),r.find("a.result-url").attr("href","/map/"+a.lat+"/"+a.lon).attr("title",a.name),r.css("display","block"),n%2==0){var i=e("<div class='row new_index_row_result'></div>").append(r);i.appendTo(".row_result_map")}else r.appendTo(".row_result_map .new_index_row_result:last");n++})}},error:function(e,t,a){}})},1e3)}}}),e.ajaxSetup({headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content"),cache:!0}}),e.fn.exists=function(){return this.length>0},e(document).bind("ajaxStart.mine",function(){e(".btn").attr("disabled","disabled")}),e(document).bind("ajaxStop.mine",function(){e(".btn").removeAttr("disabled")}),e(".live-tile").liveTile(),e('[data-toggle="filters"]').click(function(){e("#filters").toggleClass("open")}),e(".quickview-wrapper ul.map-items").scrollbar({ignoreOverlay:!1}),e(".events-form").exists()&&e("#datepicker-component, #datepicker-component2, #datepicker-component3").datepicker({format:"yyyy-mm-dd"}),e(".fotorama").exists()){var r=e(".fotorama");e(document).on("click",".fotorama__stage__frame div.fotorama__active",function(){r.fotorama().data("fotorama").requestFullScreen()})}if(e(".brand-form").exists()&&e.getScript("//connect.facebook.net/en_US/sdk.js",function(){FB.init({appId:"586408658176811",cookie:!0,version:"v2.6"}),e("#FBLogin,#feedbutton").removeAttr("disabled"),FB.getLoginStatus(statusChangeCallback)}),e("#article").submit(function(t){var a,n;a=e("input[name=_token]").val(),n=new FormData(this),e.ajax({url:"/articles",headers:{"X-CSRF-TOKEN":a},data:n,type:"POST",datatype:"JSON",processData:!1,contentType:!1,success:function(e){},error:function(e,t,a){}}),t.preventDefault()}),e("#brand-register-form").on("submit",function(t){if(e(this).valid()){t.preventDefault(t);var a,n;a=e("input[name=_token]").val();var r=document.getElementById("brand-register-form");n=new FormData(r),e.ajax({url:"/brand",headers:{"X-CSRF-TOKEN":a},data:n,type:"POST",datatype:"JSON",processData:!1,contentType:!1,success:function(e){"success"==e.status&&(window.location.href=base_url+"/brand/lists")},error:function(t,a,n){e(".error-reponse").html(t.responseJSON)}})}return!1}),e("#brand-register-form-edit").on("submit",function(t){if(e(this).valid()){t.preventDefault(t);var a,n;a=e("input[name=_token]").val();var r=document.getElementById("brand-register-form-edit");n=new FormData(r);var i=e(".brand_edit_id").val();e.ajax({url:base_url+"/brand/"+i,headers:{"X-CSRF-TOKEN":a},data:n,type:"POST",datatype:"JSON",processData:!1,contentType:!1,success:function(e){"success"==e.status&&(window.location.href=base_url+"/brand/lists")},error:function(t,a,n){e(".error-reponse").html(t.responseJSON)}})}return!1}),e("#brand-register-form, #brand-register-form-edit").exists()&&e("#brand-register-form, #brand-register-form-edit").validate({ignore:".ignore, :hidden:not(.validate)",focusInvalid:!1,ignoreTitle:!0,errorClass:"error",validClass:"success",errorElement:"span",highlight:function(t,a,n){e(t).parents("div[class='clearfix']").addClass(a).removeClass(n)},unhighlight:function(t,a,n){e(t).parents(".error").removeClass(a).addClass(n)},rules:{name:{required:!0},url_slug:{required:!0},"category[]":{required:!0},detail:{required:!0},branch_name:{required:!0},username:{required:!0},password:{required:!0},published_at:{required:!0}},messages:{name:{required:"This field is required."},url_slug:{required:"This field is required."},"category[]":{required:"This field is required."},detail:{required:"This field is required."},branch_name:{required:"This field is required."},username:{required:"This field is required."},password:{required:"This field is required."},published_at:{required:"This field is required."}},submitHandler:function(e){}}),e(".events-form").exists()&&(e.validator.addMethod("checkTags",function(t){return e(".bootstrap-tagsinput").find(".label-custom-tag").length>0}),e.validator.addMethod("checkBrand",function(t){return e("div.cs-select .cs-options").find("li.cs-selected").attr("data-value")>0})),e("#my-awesome-dropzone-form").exists()&&(e("#my-awesome-dropzone-form").validate({ignore:".ignore, :hidden:not(.validate)",focusInvalid:!1,ignoreTitle:!0,errorClass:"error",validClass:"success",errorElement:"span",highlight:function(t,a,n){e(t).parents("div[class='clearfix']").addClass(a).removeClass(n)},unhighlight:function(t,a,n){e(t).parents(".error").removeClass(a).addClass(n)},rules:{title:{required:!0},url_slug:{required:!0},"category[]":{required:!0},tag_list:{required:!0,checkTags:!0},brief:{required:!0},brand:{required:!0,checkBrand:!0},branch_name:{required:!0},published_at:{required:!0}},messages:{title:{required:"This field is required."},url_slug:{required:"This field is required."},"category[]":{required:"This field is required."},tag_list:{required:"This field is required.",checkTags:"This field is required."},brief:{required:"This field is required."},brand:{required:"This field is required.",checkBrand:"This field is required."},branch_name:{required:"This field is required."},published_at:{required:"This field is required."}},submitHandler:function(e){}}),Dropzone.options.myAwesomeDropzoneForm={paramName:"gallery",autoDiscover:!1,autoProcessQueue:!1,uploadMultiple:!0,parallelUploads:100,maxFiles:20,maxFilesize:2,acceptedFiles:"image/*",addRemoveLinks:!0,previewsContainer:"#previews",clickable:".dropzone-file-previews",init:function(){var t=this;this.element.querySelector("button[type=submit]").addEventListener("click",function(a){if(a.preventDefault(),a.stopPropagation(),e("#my-awesome-dropzone-form").valid()){e('textarea[name="description"]').html(e("#summernote").code());if(t.getQueuedFiles().length>0)t.processQueue();else{var n,r;n=e("input[name=_token]").val();var i=document.getElementById("my-awesome-dropzone-form");r=new FormData(i),e.ajax({url:"/events",headers:{"X-CSRF-TOKEN":n},data:r,type:"POST",datatype:"JSON",processData:!1,contentType:!1,success:function(e){window.location.href=base_url+"/admin"},error:function(t,a,n){e(".error-reponse").html(t.responseJSON)}})}}}),this.on("sending",function(t,a,n){var t=e("#image")[0].files[0];n.append("image",t),n.append("_token",e("[name=_token").val())}),this.on("complete",function(){if(0==this.getQueuedFiles().length&&0==this.getUploadingFiles().length){window.location.href=base_url+"/admin"}}),this.on("addedfile",function(t){e(".dropzone-previews").find(".dz-preview").length>0&&e(".dropzone-file-previews .dz-message").hide()}),this.on("removedfile",function(e){}),this.on("sendingmultiple",function(){}),this.on("successmultiple",function(e,t){}),this.on("errormultiple",function(e,t){})}}),e("#my-awesome-dropzone-form-edit").exists()&&(e(".branch").is(":checked")&&e(".branch_all").prop("checked",0==e(".branch_child").has(":checkbox:not(:checked)").length),e("#my-awesome-dropzone-form-edit").validate({ignore:".ignore, :hidden:not(.validate)",focusInvalid:!1,ignoreTitle:!0,errorClass:"error",validClass:"success",errorElement:"span",highlight:function(t,a,n){e(t).parents("div[class='clearfix']").addClass(a).removeClass(n)},unhighlight:function(t,a,n){e(t).parents(".error").removeClass(a).addClass(n)},rules:{title:{required:!0},url_slug:{required:!0},"category[]":{required:!0},tag_list:{required:!0,checkTags:!0},brief:{required:!0},branch_name:{required:!0},published_at:{required:!0}},messages:{title:{required:"This field is required."},url_slug:{required:"This field is required."},"category[]":{required:"This field is required."},tag_list:{required:"This field is required.",checkTags:"This field is required."},brief:{required:"This field is required."},branch_name:{required:"This field is required."},published_at:{required:"This field is required."}},submitHandler:function(e){}}),Dropzone.options.myAwesomeDropzoneFormEdit={paramName:"gallery",autoDiscover:!1,autoProcessQueue:!1,uploadMultiple:!0,parallelUploads:100,maxFiles:20,maxFilesize:2,acceptedFiles:"image/*",addRemoveLinks:!0,previewsContainer:"#previews",clickable:".dropzone-file-previews",init:function(){var t=this,a=e.parseJSON(e("#thumb_mock").val());e.each(a,function(e,a){var n={name:a.name,size:a.size};t.options.addedfile.call(t,n),t.options.thumbnail.call(t,n,a.fileinfo)}),this.element.querySelector("button[type=submit]").addEventListener("click",function(a){if(a.preventDefault(),a.stopPropagation(),e("#my-awesome-dropzone-form-edit").valid()){e('textarea[name="description"]').html(e("#summernote").code());if(t.getQueuedFiles().length>0)t.processQueue();else{var n,r;n=e("input[name=_token]").val();var i=document.getElementById("my-awesome-dropzone-form-edit");r=new FormData(i);var o=e(".event_edit_id").val();e.ajax({url:base_url+"/events/"+o,headers:{"X-CSRF-TOKEN":n},data:r,type:"POST",datatype:"JSON",processData:!1,contentType:!1,success:function(e){window.location.href=base_url+"/admin"},error:function(t,a,n){e(".error-reponse").html(t.responseJSON)}})}}}),this.on("sending",function(t,a,n){var t=e("#image")[0].files[0];n.append("image",t),n.append("_token",e("[name=_token").val())}),this.on("complete",function(){if(0==this.getQueuedFiles().length&&0==this.getUploadingFiles().length){window.location.href=base_url+"/admin"}}),this.on("addedfile",function(t){e(".dropzone-previews").find(".dz-preview").length>0&&e(".dropzone-file-previews .dz-message").hide()}),this.on("removedfile",function(t){var a=e("input[name=_token]").val(),n=e(".event_edit_id").val(),r=t.name;e.ajax({url:base_url+"/events/removefile/"+n+"/"+r,headers:{"X-CSRF-TOKEN":a},type:"GET",datatype:"JSON",processData:!1,contentType:!1,success:function(t){e(".dropzone-previews").find(".dz-preview").length<1&&e(".dropzone-file-previews .dz-message").show()},error:function(t,a,n){e(".error-reponse").html(t.responseJSON)}})}),this.on("sendingmultiple",function(){}),this.on("successmultiple",function(e,t){}),this.on("errormultiple",function(e,t){})}}),e(".custom-tag-input").exists()&&e(".custom-tag-input").tagsinput({maxTags:20,tagClass:function(e){return"label label-custom-tag"}}),e("#summernote").exists()){e("#summernote").summernote({height:200,styleTags:["pre","h1","h2"],toolbar:[["style",["style","bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["view",["fullscreen","codeview"]],["picture",["picture"]]],onImageUpload:function(e,t,a){sendFile(e[0],t,a)}})}if(e(".note-modal-form").each(function(){e(this).validate({})}),e("#category").exists()&&e("#category").select2({maximumSelectionSize:2,formatSelectionTooBig:function(e){return"Too many selected items"}}),e("#category").on("change",function(){e(this).valid()}),e(".social_group").exists()){var i=document.querySelector(".js-check-change"),o=document.querySelector(".js-check-change-field");i.onchange=function(){o.value=i.checked,1==i.checked?e(".social_group").show():e(".social_group").hide()}}if(e(".events-form .cs-select").exists()){var s=e(".cs-select.cs-select-brand").get(0);e(s).wrap('<div class="cs-wrapper" />'),new SelectFx(s,{onChange:function(t){var a=e(t).val();window.fx_select_brand=a;var n=e(".branch_child .list"),r=e(".brand-category");"none"!=e(".new_branch_panel").css("display")&&e(".add_new_branch").trigger("click"),
n.html(""),e(".new_branch_btn").hide(),e(".check-branch-all").hide(),a>0&&e.ajax({url:"/events/brand/"+a,contentType:!1,processData:!1,dataType:"JSON",type:"GET",success:function(t){Object.keys(t.branch).length>0?(n.html(""),e.each(t.branch,function(e,t){n.append('<div class="checkbox check-warning"><input type="checkbox" checked="checked" name="branch[]" class="branch" value="'+e+'" id="branch_'+e+'" /><label for="branch_'+e+'">'+t+"</label></div>")}),n.append('<div class="clearfix"></div>'),e(".branch").is(":checked")&&e(".branch_all").prop("checked",0==e(".branch_child").has(":checkbox:not(:checked)").length),e(".check-branch-all").show()):e(".branch_child .list").append('<div class="checkbox"></div>'),Object.keys(t.category).length>0&&(r.html(""),e.each(t.category,function(e,t){r.append('<input type="text" name="category[]" class="brand-category" value="'+e+'" id="category_'+e+'" />')})),e(".new_branch_btn").show()},error:function(e,t,a){}})}})}e(".new_branch_panel").exists(),e(document).on("change",".branch_all",function(t){var a=e(".branch_child");a.find(":checkbox").prop("checked",this.checked)}),e(document).on("change",".branch",function(t){var a=e(".branch_all"),n=e(".branch_child"),r=e(this);r.is(":checked")?a.prop("checked",0==n.has(":checkbox:not(:checked)").length):a.prop("checked",!1)}),e(document).on("change",".published_check",function(t){this.checked?e(".published_set_time").hide():e(".published_set_time").show()}),e(document).on("change",".btn-file :file",function(){var t=e(this),a=t.get(0).files?t.get(0).files.length:1,n=t.val().replace(/\\/g,"/").replace(/.*\//,"");t.trigger("fileselect",[a,n])}),e(".btn-file :file").on("fileselect",function(t,a,n){var r=e(this).parents(".input-group").find(":text"),i=a>1?a+" files selected":n;r.length?r.val(i):i&&alert(i)})}),e(".panel-collapse label").on("click",function(e){e.stopPropagation()})}(window.jQuery),$(document).on("click","#FBLogin",function(){return facebookLogin(),!1}),$(document).on("click","#add_branch",function(){if($("#branch_name").valid()){var e=$("input[name=_token]").val(),t=window.fx_select_brand;"undefined"==typeof t&&(t=$("#brand_id").val());var a=$(".brand_branch_row"),n=$(".event_branch_row"),r=$("#branch_name").val(),i=$("#branch_detail").val(),o=$("#branch_location").val(),s=$("#branch_location_lat").val(),l=$("#branch_location_lon").val(),c=$("#branch_location_zoom").val(),d={brand_id:t,branch_name:r,branch_detail:i,branch_location:o,branch_lat:s,branch_lon:l,branch_zoom:c};$.ajax({url:"/brand/add_branch",headers:{"X-CSRF-TOKEN":e},data:JSON.stringify(d),type:"POST",datatype:"JSON",processData:!1,contentType:!1,success:function(e){var r=$("#branch_name").val(),i=e.branch_id;if("success"==e.status){if(""!=t&&$(n).exists()){var o=$(".event_branch_row > div.branch_row").clone();o.find("label").attr("for","branch_"+i).html(r),o.find(".branch").attr("id","branch_"+i).val(i),$(".list .checkbox").exists()?$(".list .checkbox:last").after(o):o.appendTo(".list")}else if($(a).exists()){var o=$(".brand_branch_row > div.branch_row").clone();o.find(".branch_name_list").html(r),o.find(".branch_id").val(i),o.appendTo("#branch_list")}"none"==$(".check-branch-all").css("display")&&$(".check-branch-all").show(),$(".add_new_branch").trigger("click"),$("html, body").animate({scrollTop:$(".master-checkbox-all").offset().top-20},"slow")}},error:function(e,t,a){}})}});var map,mapObj,place="",address="",point="";